const appURL=new URL(window.location);function guid(){let a=()=>Math.floor(65536*(1+Math.random())).toString(16).substring(1);return a()+a()+'-'+a()+'-'+a()+'-'+a()+'-'+a()+a()+a()}class ROUTER{constructor(){this.routes={},this.url=new URL(window.location),this.path=this.url.pathname,[this.base,this.sub]=this.path.split('/').filter((a)=>a),this.params=Array.from(this.url.searchParams.entries()).reduce((a,b)=>(a[b[0]]=b[1],a),{}),this.params.subURL=this.sub,this.params.baseURL=this.base}addRoutes(a){for(let b in a)this.routes[b]=a[b];this.go()}addRoute(a,b){this.routes[a]=b,this.go()}go(a){let b=a||this.path,c=b.length;!c||1>=c?b='/':!this.routes[b]&&(b=Object.keys(this.routes).sort((c,a)=>c>a?-1:1).find((a)=>new RegExp(b,'ig').test(a)||new RegExp(a,'ig').test(b))),this.traverse(b)}clearTemplates(){return $('.wrapper,link[for]').remove()}getTemplate(a){let b=$(`.wrapper.${a}`);return b=b.length&&Promise.resolve(b),b?b:$.get(`/views/${a}.html`).promise().then((b)=>{let c=[$(`link[for=${a}]`),$(`<link rel="stylesheet" href="/css/${a}.css" for="${a}">`)].find((a)=>a.length);return new Promise((d)=>c.appendTo(document.head).on('load',d.bind(null,$(`<section class="wrapper ${a}">`).html(b))))})}traverse(a,b){return b=b||this.routes[a]||(a='/')&&{view:'main',init:()=>{}},b.init=b.init||(()=>{}),this.getTemplate(b.view).then((a)=>a.appendTo('#content')).then(b.init.bind(null,this.params))}}const Router=new ROUTER;